---
title: 끄적이며 정리하는 Diffusion Model
author: onebom
date: 2024-02-27 00:00:00 +0800
categories: []
tags: []
toc: true
published: true
---

## 1. What is a Diffusion Model
diffusion model의 시작은 논문 abstarct에 쓰여있듯이 non-equilibrium thermodynamics이다. 

!! 비평형 열역학에 대해 간단하게 작성


해당 모델은 Markov chain에 기반하여 데이터에 rnadom noise를 천천히 추가하는 diffusion 단계를 정의하고,   
완전 노이즈로부터 원하는 데이터 샘플을 구성하는 diffusion reverse 단계를 학습한다.
다른 생성모델과 달리, latent variable이 원본데이터와 동일한 높은 dimensionality를 가진다.
![figure1](/assets/img/posts/ddpm/figure1.png)

!! diffusion model vs ddpm 

DDPM paper Abstarct의 아래 두줄에 집중해서 본 post를 읽어볼 것이다. 
> diffusion probabilistic model과 denoising score matching with Langevin dtnamics를 연결한 weighted variational bound를 통해 좋은 학습결과를 냈다.
> 또한, autoregressive deocding을 일반화한 progressive lossy decompression scheme을 제안한다.
워낙 생소한 단어로 abstract에서 모델을 설명하고 있기에, 이를 간단하게 설명하고자 한다.   
따라서 본 글을 읽을땐, 아래의 질문3개를 기억하며 읽어주길 바란다.
<details>
<summary>**[QnA]**</summary>
<div markdown="1">
1. 비평형 열역학과 DDPM의 공통점은?
2. weithted variational bound가 무엇을 말하는 지
3. progressive lossy decompression이 어떻게 일어나는지
</div>
</details>

## 2. How does it work?
> A diffusion probabilistic model(which we will call a “diffusion model” for brevity) is a parameterized Markov chain trained using variational inference to produce samples matching the data after finite time

### Foward diffusion process
실제 데이터 분포에서 샘플링한 data point $$x_0 ~ q(x)$$가 주어졌을 때, 해당 샘플에 T스텝만큼 소량의 Gaussian noise를 추가하며 $$x_1,...,x_T$$ noisy smaples sequence를 얻는다.
- 이때 각 step의 size는 variance schdule에 의해 0에서 1사이로 조정된다: $${\beta_{t} \in (0,1)}^{T}_{t=1}$$

이 과정을 식으로 표현하면 다음과 같다;

$$q(x_t|x_{t-1})=N(x_t;\root{1-\beta_t}x_{t-1},\beta_{t}\mathbb{I}) \rightarrow q(x_{1:T}|x_0)= $$

### Reverse diffusion process
### connectio with noise-conditioned score network(NCSN)


## 3. Why does it work wll?
### Mathemetical Relationship with SDE and Score Matching

## 4. Advanced Fast Sampling: DDImplicitM


